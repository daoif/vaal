# VAAL 执行任务引导

本文档用于引导 AI 帮助用户执行任务。

---

## 触发方式

当用户说以下话时，表示需要执行任务：
- "帮我执行任务"
- "开始执行"
- "运行任务"

---

## 阶段一：检查准备

### 1.1 检查必要文件

确认以下文件存在：
- `.vaal/_workspace/exec/tasks.md` - 任务列表
- `.vaal/_workspace/exec/config.json` - 配置文件

如果不存在，提示用户：
- tasks.md 不存在：需要先拆分任务，对我说"帮我拆分任务"
- config.json 不存在：需要先初始化，对我说"帮我初始化 VAAL"

### 1.2 确认任务列表

读取 tasks.md，向用户展示：
- 待完成任务数量
- 已完成任务数量
- 第一个待执行的任务

询问用户是否确认开始执行。

---

## 阶段二：执行任务

### 2.1 输出执行命令

> ⚠️ **重要**：不要自己执行这个命令，输出给用户让他们在终端执行。
> 
> 因为执行过程需要多次调用 AI CLI，耗时较长，不适合在对话中等待。

```
准备就绪。请在终端执行以下命令开始执行任务：

node .vaal/exec/scripts/run.js

执行完成后回来告诉我，我帮你审查结果。
```

---

## 阶段三：审查结果

当用户说"执行完了"或"执行完成了"时，进入审查阶段。

### 3.1 读取进度

读取 `.vaal/_workspace/exec/progress.txt`，向用户展示：
- 已完成的任务列表
- 每个任务的执行时间
- 是否有失败的任务

### 3.2 处理失败情况

如果有任务失败：
- 读取失败任务的错误信息
- 帮助用户分析原因
- 可以手动修复后重新执行

### 3.3 后续步骤

全部完成后，提示用户：

```
所有任务已完成。建议你：
1. 审查生成的代码
2. 运行测试确认功能正常
3. 如发现问题，对我说"帮我添加修复任务"
```

---

## 配置参考

`config.json` 关键配置项：

| 配置项 | 说明 |
|--------|------|
| `execution.tool` | AI CLI 工具（codex/claude/自定义） |
| `validation.test` | 测试命令 |
| `validation.lint` | Lint 命令 |
| `git.autoCommit` | 是否自动提交 |

详细配置说明见 [CONFIG.schema.md](./CONFIG.schema.md)。

---

## 注意事项

1. **不要自己执行命令** - 执行过程耗时长，让用户在终端执行
2. **关注失败任务** - 帮助用户理解失败原因
3. **引导代码审查** - 执行完成后提醒用户审查代码
